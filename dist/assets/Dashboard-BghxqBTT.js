import{u as y,r as k,a as c,o as w,c as r,b as i,d as s,t as u,e as x,F as h,f as P,g as E,w as U,h as m,v as b,s as C}from"./index-rAF5i6Tv.js";const D={class:"container mx-auto p-6"},M={key:0,class:"flex justify-center"},N={key:1,class:"alert alert-error mb-6"},V={key:2},B={class:"space-y-4 mb-8"},L={class:"card-body"},S={class:"flex justify-between items-center"},j={class:"card-title"},F={class:"text-sm text-gray-600"},R=["onClick"],q={class:"card bg-base-100 shadow"},z={class:"card-body"},T={class:"form-control"},$={class:"form-control"},A={class:"form-control"},G={key:0,class:"card bg-base-100 shadow mt-6"},H={class:"card-body"},I={class:"card-title"},Q={__name:"Dashboard",setup(J){const a=y(),l=k({display_name:"",slug:"",description:""}),n=c(null),v=c([]),p=c(!1),d=c(null);function _(o){a.activeProfile=o,n.value=o,f(o)}async function f(o){p.value=!0,d.value=null;const{data:e,error:t}=await C.from("links").select("id, title, url, position").eq("profile_id",o.id).order("position",{ascending:!0});t?(d.value="Error cargando los links: "+t.message,v.value=[]):v.value=e,p.value=!1}async function g(){if(!l.display_name||!l.slug){alert("Por favor completa el nombre público y el slug.");return}const{data:o,error:e}=await a.createProfile({display_name:l.display_name,slug:l.slug,description:l.description});e?alert("Error al crear perfil: "+e.message):(alert("Perfil creado correctamente."),l.display_name="",l.slug="",l.description="",await a.fetchProfiles())}return w(()=>{a.activeProfile&&(n.value=a.activeProfile,f(a.activeProfile))}),(o,e)=>(i(),r("div",D,[e[10]||(e[10]=s("h2",{class:"text-2xl font-bold mb-6"},"Mis Perfiles",-1)),p.value?(i(),r("div",M,e[3]||(e[3]=[s("span",{class:"loading loading-spinner loading-lg"},null,-1)]))):d.value?(i(),r("div",N,[e[4]||(e[4]=s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),s("span",null,u(d.value),1)])):(i(),r("div",V,[s("ul",B,[(i(!0),r(h,null,P(E(a).profiles,t=>(i(),r("li",{key:t.id,class:"card bg-base-100 shadow"},[s("div",L,[s("div",S,[s("div",null,[s("h3",j,u(t.display_name),1),s("p",F,u(t.slug),1)]),s("button",{onClick:K=>_(t),class:"btn btn-primary btn-sm"}," Editar ",8,R)])])]))),128))]),s("div",q,[s("div",z,[e[9]||(e[9]=s("h3",{class:"card-title mb-4"},"Crear nuevo perfil",-1)),s("form",{onSubmit:U(g,["prevent"]),class:"space-y-4"},[s("div",T,[e[5]||(e[5]=s("label",{class:"label"},[s("span",{class:"label-text"},"Nombre público")],-1)),m(s("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>l.display_name=t),placeholder:"Nombre público",class:"input input-bordered"},null,512),[[b,l.display_name]])]),s("div",$,[e[6]||(e[6]=s("label",{class:"label"},[s("span",{class:"label-text"},"URL (slug)")],-1)),m(s("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>l.slug=t),placeholder:"URL (slug)",class:"input input-bordered"},null,512),[[b,l.slug]])]),s("div",A,[e[7]||(e[7]=s("label",{class:"label"},[s("span",{class:"label-text"},"Descripción")],-1)),m(s("textarea",{"onUpdate:modelValue":e[2]||(e[2]=t=>l.description=t),placeholder:"Descripción",class:"textarea textarea-bordered"},null,512),[[b,l.description]])]),e[8]||(e[8]=s("button",{type:"submit",class:"btn btn-success"}," Crear ",-1))],32)])]),n.value?(i(),r("div",G,[s("div",H,[s("h3",I,"Editando: "+u(n.value.display_name),1)])])):x("",!0)]))]))}};export{Q as default};
