import{c as r,e as m,b as n,d as e,t as a,A as Y,k as ee,p as te,a as T,u as se,q as oe,o as le,x as ne,C as re,w as ae,h as b,v as g,g as o,n as U,i as V,F as E,f as N,E as ie,y as D,z as de,j}from"./index-rAF5i6Tv.js";import{u as ue,a as ce}from"./useProfiles-aMZRDD3X.js";import{Q as pe}from"./qrcode.vue.esm-D401QsQY.js";const be={key:0,class:"modal modal-open"},me={class:"modal-box"},fe={class:"font-bold text-lg"},ve={class:"py-4"},ge={__name:"ConfirmDialog",props:{show:Boolean,title:{type:String,default:"Confirmar eliminación"},message:{type:String,default:"¿Estás seguro que deseas eliminar este perfil? Esta acción no se puede deshacer."}},emits:["confirm","cancel"],setup(x,{emit:C}){const f=C,v=()=>f("confirm"),h=()=>f("cancel");return($,i)=>x.show?(n(),r("div",be,[e("div",me,[e("h3",fe,a(x.title),1),e("p",ve,a(x.message),1),e("div",{class:"modal-action"},[e("button",{onClick:h,class:"btn btn-ghost"},"Cancelar"),e("button",{onClick:v,class:"btn btn-error"},"Confirmar")])])])):m("",!0)}},xe={class:"max-w-2xl mx-auto"},he={class:"form-control"},ye={key:0,class:"label"},we={class:"form-control"},ke={class:"form-control"},_e={class:"form-control"},Ce=["onUpdate:modelValue","onInput"],$e={key:1,class:"content-center input flex-[1] max-w-[120px] bg-base-200"},Se=["onUpdate:modelValue","placeholder","onInput"],Le=["onClick"],Te={class:"flex gap-2 mt-2 flex-wrap"},Ue={class:"flex gap-2 mt-4 items-center"},Ve=["value"],Ee=["disabled"],Pe={class:"flex gap-4 justify-end mt-6"},Be=["disabled"],Ie={key:0,class:"loading loading-spinner"},Me={key:0,class:"alert alert-error"},Ne={key:0,class:"mt-10"},De={class:"card bg-base-100 border-base-200 border rounded-xl"},je={class:"card-body flex flex-col md:flex-row md:justify-between md:items-end gap-4"},ze={class:"flex-1"},Fe={class:"card-title truncate"},qe={class:"text-gray-600 text-sm truncate"},Ae={class:"flex flex-col items-end gap-2"},Re=["href"],Ge={class:"w-36 h-36"},Qe={class:"alert alert-error mt-10"},He={__name:"ProfileEdit",setup(x){const C=Y(),f=ee(),v=te(),h=C.params.id,$=window.location.origin,i=T(!1),S=T(null),z=se(),d=T(""),u=ue(),{displayName:y,tagline:w,description:k,links:P,loading:L,error:B,errorField:I,profileSlug:_,addLink:c,removeLink:F,saveProfile:q,loadProfile:A}=ce(h),R=l=>u.getLinkType(l).label,G=l=>u.shouldShowTitleInput(l),Q=l=>u.getLinkPlaceholder(l),W=oe(()=>u.otherLinkTypes),O=l=>{l.error=!1;const t=u.formatSocialUrl(l);t!==l.url&&(l.url=t)},Z=()=>{d.value&&(c(d.value),d.value="")},H=async()=>{P.value.forEach(t=>{t.url&&(t.url=u.formatSocialUrl(t))}),await q()&&(v.success("Perfil guardado correctamente"),setTimeout(()=>{f.push("/profiles")},1e3))},J=l=>{S.value=l,i.value=!0},K=async()=>{if(i.value=!1,!!S.value)try{await z.deleteProfile(S.value)&&(v.success("Perfil eliminado correctamente"),f.push("/profiles"))}catch(l){v.error(l.message||"Error al eliminar el perfil")}};return le(()=>{A()}),(l,t)=>{const X=ne("router-link");return n(),r(E,null,[e("div",xe,[t[23]||(t[23]=e("h2",{class:"text-2xl font-bold text-center mb-6"},"Editar Perfil",-1)),e("form",{onSubmit:ae(H,["prevent"]),class:"space-y-6"},[e("div",he,[t[12]||(t[12]=e("label",{class:"label"},[e("span",{class:"label-text"},"Nombre público")],-1)),b(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>V(y)?y.value=s:null),type:"text",class:U(["input input-bordered",{"input-error":o(I)==="displayName"}])},null,2),[[g,o(y)]]),o(I)==="displayName"?(n(),r("label",ye,t[11]||(t[11]=[e("span",{class:"label-text-alt text-error"},"El nombre público es obligatorio",-1)]))):m("",!0)]),e("div",we,[t[13]||(t[13]=e("label",{class:"label"},[e("span",{class:"label-text"},"Tagline")],-1)),b(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>V(w)?w.value=s:null),type:"text",class:"input input-bordered"},null,512),[[g,o(w)]])]),e("div",ke,[t[14]||(t[14]=e("label",{class:"label"},[e("span",{class:"label-text"},"Descripción")],-1)),b(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=s=>V(k)?k.value=s:null),rows:"4",class:"textarea textarea-bordered"},null,512),[[g,o(k)]])]),e("div",_e,[t[17]||(t[17]=e("h3",{class:"text-lg font-semibold mb-2"},"Links",-1)),(n(!0),r(E,null,N(o(P),(s,M)=>(n(),r("div",{key:M,class:"flex gap-2 items-center mb-2"},[G(s.type)?b((n(),r("input",{key:0,"onUpdate:modelValue":p=>s.title=p,placeholder:"Título del link",class:U(["input input-bordered flex-[1] max-w-[120px]",{"input-error":s.error}]),onInput:p=>s.error=!1},null,42,Ce)),[[g,s.title]]):(n(),r("div",$e,a(R(s.type)),1)),b(e("input",{"onUpdate:modelValue":p=>s.url=p,placeholder:Q(s.type),class:U(["input input-bordered flex-1",{"input-error":s.error}]),onInput:p=>O(s)},null,42,Se),[[g,s.url]]),e("button",{type:"button",class:"btn btn-square btn-sm btn-error size-10",onClick:p=>o(F)(M),"aria-label":"Eliminar link"},t[15]||(t[15]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,Le)]))),128)),e("div",Te,[e("button",{type:"button",onClick:t[3]||(t[3]=s=>o(c)("website")),class:"btn btn-primary btn-sm"}," + Sitio Web "),e("button",{type:"button",onClick:t[4]||(t[4]=s=>o(c)("instagram")),class:"btn btn-primary btn-sm bg-pink-400 border-pink-600 hover:bg-pink-500 hover:border-pink-600 hover:text-white"}," + Instagram "),e("button",{type:"button",onClick:t[5]||(t[5]=s=>o(c)("facebook")),class:"btn btn-primary btn-sm bg-blue-400 border-blue-600 hover:bg-blue-500 hover:border-blue-600 hover:text-white"}," + Facebook "),e("button",{type:"button",onClick:t[6]||(t[6]=s=>o(c)("whatsapp")),class:"btn btn-primary btn-sm bg-green-400 border-green-600 hover:bg-green-500 hover:border-green-600 hover:text-white"}," + WhatsApp "),e("button",{type:"button",onClick:t[7]||(t[7]=s=>o(c)("email")),class:"btn btn-primary btn-sm bg-gray-400 border-gray-600 hover:bg-gray-500 hover:border-gray-600 hover:text-white"}," + Email ")]),e("div",Ue,[b(e("select",{"onUpdate:modelValue":t[8]||(t[8]=s=>d.value=s),class:"select select-bordered flex-1"},[t[16]||(t[16]=e("option",{value:""},"Otra red social...",-1)),(n(!0),r(E,null,N(W.value,s=>(n(),r("option",{key:s.value,value:s.value},a(s.label),9,Ve))),128))],512),[[ie,d.value]]),e("button",{type:"button",onClick:Z,class:"btn btn-primary",disabled:!d.value}," Agregar ",8,Ee)])]),e("div",Pe,[D(X,{to:"/profiles",class:"btn btn-default"},{default:de(()=>t[18]||(t[18]=[j(" Cancelar ",-1)])),_:1,__:[18]}),e("button",{type:"submit",class:"btn btn-primary",disabled:o(L)},[o(L)?(n(),r("span",Ie)):m("",!0),j(" "+a(o(L)?"Guardando...":"Guardar Cambios"),1)],8,Be)]),o(B)?(n(),r("div",Me,[t[19]||(t[19]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("span",null,a(o(B)),1)])):m("",!0)],32),o(_)?(n(),r("section",Ne,[t[20]||(t[20]=e("h3",{class:"text-lg font-semibold mb-2"},"Perfil público",-1)),e("div",De,[e("div",je,[e("div",ze,[e("h2",Fe,a(o(y)),1),e("p",qe,a(o(w)||o(k)),1)]),e("div",Ae,[e("a",{href:`${o($)}/p/${o(_)}`,target:"_blank",class:"text-primary font-mono text-xs hover:underline"}," /"+a(o(_)),9,Re),e("div",Ge,[D(pe,{value:`${o($)}/p/${o(_)}`,size:150},null,8,["value"])])])])])])):m("",!0),e("div",Qe,[t[21]||(t[21]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1)),t[22]||(t[22]=e("div",null,[e("h3",{class:"font-bold"},"Zona peligrosa")],-1)),e("button",{onClick:t[9]||(t[9]=s=>J(o(h))),class:"btn btn-error btn-sm"}," Eliminar permanentemente ")])]),i.value?(n(),re(ge,{key:0,show:i.value,onConfirm:K,onCancel:t[10]||(t[10]=s=>i.value=!1)},null,8,["show"])):m("",!0)],64)}}};export{He as default};
