import{c as r,e as i,b as o,d as t,t as d,A as oe,k as ne,p as re,a as M,u as ae,q as ie,o as de,x as ue,C as pe,w as be,h as p,v as g,g as s,n as V,i as U,j as N,F as D,f as q,E as ce,y as R,z as me}from"./index-B3C7ulGV.js";import{u as ve,a as fe}from"./useProfiles-B2M65liV.js";import{Q as ge}from"./qrcode.vue.esm-RxH3tMmn.js";const xe={key:0,class:"modal modal-open"},ye={class:"modal-box"},ke={class:"font-bold text-lg"},he={class:"py-4"},we={__name:"ConfirmDialog",props:{show:Boolean,title:{type:String,default:"Confirmar eliminación"},message:{type:String,default:"¿Estás seguro que deseas eliminar este perfil? Esta acción no se puede deshacer."}},emits:["confirm","cancel"],setup(k,{emit:h}){const x=h,y=()=>x("confirm"),w=()=>x("cancel");return(E,b)=>k.show?(o(),r("div",xe,[t("div",ye,[t("h3",ke,d(k.title),1),t("p",he,d(k.message),1),t("div",{class:"modal-action"},[t("button",{onClick:w,class:"btn btn-ghost"},"Cancelar"),t("button",{onClick:y,class:"btn btn-error"},"Confirmar")])])])):i("",!0)}},_e={class:"max-w-2xl mx-auto"},Ce={class:"form-control"},Se={key:0,class:"label"},$e={class:"form-control"},Le={class:"flex gap-2"},Te=["disabled"],Ve={key:0,class:"loading loading-spinner loading-sm"},Ue={key:0,class:"label"},Ee={key:1,class:"label"},Pe={key:2,class:"label"},Ie={key:3,class:"label"},Be={class:"label-text-alt text-error"},Me={class:"form-control"},Ne={class:"form-control"},De={class:"form-control"},je=["onUpdate:modelValue","onInput"],ze={key:1,class:"content-center input flex-[1] max-w-[120px] bg-base-200"},Ae=["onUpdate:modelValue","placeholder","onInput"],Fe=["onClick"],qe={class:"flex gap-2 mt-2 flex-wrap"},Re={class:"flex gap-2 mt-4 items-center"},Ge=["value"],Qe=["disabled"],We={class:"flex gap-4 justify-end mt-6"},Oe=["disabled"],Ze={key:0,class:"loading loading-spinner"},He={key:0,class:"alert alert-error"},Je={key:0,class:"mt-10"},Ke={class:"card bg-base-100 border-base-200 border rounded-xl"},Xe={class:"card-body flex flex-col md:flex-row md:justify-between md:items-end gap-4"},Ye={class:"flex-1"},et={class:"card-title truncate"},tt={class:"text-gray-600 text-sm truncate"},st={class:"flex flex-col items-end gap-2"},lt=["href"],ot={class:"w-36 h-36"},nt={class:"alert alert-error mt-10"},dt={__name:"ProfileEdit",setup(k){const h=oe(),x=ne(),y=re(),w=h.params.id,E=window.location.origin,b=M(!1),P=M(null),G=ae(),c=M(""),m=ve(),{displayName:_,tagline:C,description:S,links:j,loading:I,error:B,errorField:$,profileSlug:L,slug:a,slugAvailability:u,addLink:v,removeLink:Q,saveProfile:W,loadProfile:O,validateSlug:T,checkSlugAvailability:z,onSlugInput:A}=fe(w,h.params.slug),Z=n=>m.getLinkType(n).label,H=n=>m.shouldShowTitleInput(n),J=n=>m.getLinkPlaceholder(n),K=ie(()=>m.otherLinkTypes),X=n=>{n.error=!1;const e=m.formatSocialUrl(n);e!==n.url&&(n.url=e)},Y=()=>{c.value&&(v(c.value),c.value="")},ee=async()=>{j.value.forEach(e=>{e.url&&(e.url=m.formatSocialUrl(e))}),await W()&&(y.success("Perfil guardado correctamente"),setTimeout(()=>{x.push("/profiles")},1e3))},te=n=>{P.value=n,b.value=!0},se=async()=>{if(b.value=!1,!!P.value)try{await G.deleteProfile(P.value)&&(y.success("Perfil eliminado correctamente"),x.push("/profiles"))}catch(n){y.error(n.message||"Error al eliminar el perfil")}};return de(()=>{O().then(()=>{})}),(n,e)=>{const le=ue("router-link");return o(),r(D,null,[t("div",_e,[e[31]||(e[31]=t("h2",{class:"text-2xl font-bold text-center mb-6"},"Editar Perfil",-1)),t("form",{onSubmit:be(ee,["prevent"]),class:"space-y-6"},[t("div",Ce,[e[16]||(e[16]=t("label",{class:"label"},[t("span",{class:"label-text"},"Nombre público")],-1)),p(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>U(_)?_.value=l:null),type:"text",class:V(["input input-bordered",{"input-error":s($)==="displayName"}])},null,2),[[g,s(_)]]),s($)==="displayName"?(o(),r("label",Se,e[15]||(e[15]=[t("span",{class:"label-text-alt text-error"},"El nombre público es obligatorio",-1)]))):i("",!0)]),t("div",$e,[e[20]||(e[20]=t("label",{class:"label"},[t("span",{class:"label-text"},"Slug único")],-1)),t("div",Le,[p(t("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>U(a)?a.value=l:null),type:"text",placeholder:"mi-perfil",class:V(["input input-bordered flex-1",{"input-error":s(a)&&!s(T)(s(a))||s($)==="slug","input-success":s(a)&&s(u)==="available","input-warning":s(a)&&s(u)==="checking"}]),onBlur:e[2]||(e[2]=l=>s(T)(s(a))),onInput:e[3]||(e[3]=(...l)=>s(A)&&s(A)(...l))},null,34),[[g,s(a)]]),t("button",{type:"button",class:"btn btn-outline",disabled:!s(a)||!s(T)(s(a))||s(u)==="checking",onClick:e[4]||(e[4]=(...l)=>s(z)&&s(z)(...l))},[s(u)==="checking"?(o(),r("span",Ve)):i("",!0),N(" "+d(s(u)==="checking"?"Verificando...":"Verificar"),1)],8,Te)]),s(a)&&!s(T)(s(a))?(o(),r("label",Ue,e[17]||(e[17]=[t("span",{class:"label-text-alt text-error"},"Solo letras, números y guiones. Mínimo 3 caracteres.",-1)]))):i("",!0),s(a)&&s(u)==="available"?(o(),r("label",Ee,e[18]||(e[18]=[t("span",{class:"label-text-alt text-success"},"✅ Slug disponible",-1)]))):i("",!0),s(a)&&s(u)==="unavailable"?(o(),r("label",Pe,e[19]||(e[19]=[t("span",{class:"label-text-alt text-error"},"❌ Slug no disponible",-1)]))):i("",!0),s($)==="slug"?(o(),r("label",Ie,[t("span",Be,d(s(B)),1)])):i("",!0)]),t("div",Me,[e[21]||(e[21]=t("label",{class:"label"},[t("span",{class:"label-text"},"Tagline")],-1)),p(t("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>U(C)?C.value=l:null),type:"text",class:"input input-bordered"},null,512),[[g,s(C)]])]),t("div",Ne,[e[22]||(e[22]=t("label",{class:"label"},[t("span",{class:"label-text"},"Descripción")],-1)),p(t("textarea",{"onUpdate:modelValue":e[6]||(e[6]=l=>U(S)?S.value=l:null),rows:"4",class:"textarea textarea-bordered"},null,512),[[g,s(S)]])]),t("div",De,[e[25]||(e[25]=t("h3",{class:"text-lg font-semibold mb-2"},"Links",-1)),(o(!0),r(D,null,q(s(j),(l,F)=>(o(),r("div",{key:F,class:"flex gap-2 items-center mb-2"},[H(l.type)?p((o(),r("input",{key:0,"onUpdate:modelValue":f=>l.title=f,placeholder:"Título del link",class:V(["input input-bordered flex-[1] max-w-[120px]",{"input-error":l.error}]),onInput:f=>l.error=!1},null,42,je)),[[g,l.title]]):(o(),r("div",ze,d(Z(l.type)),1)),p(t("input",{"onUpdate:modelValue":f=>l.url=f,placeholder:J(l.type),class:V(["input input-bordered flex-1",{"input-error":l.error}]),onInput:f=>X(l)},null,42,Ae),[[g,l.url]]),t("button",{type:"button",class:"btn btn-square btn-sm btn-error size-10",onClick:f=>s(Q)(F),"aria-label":"Eliminar link"},e[23]||(e[23]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,Fe)]))),128)),t("div",qe,[t("button",{type:"button",onClick:e[7]||(e[7]=l=>s(v)("website")),class:"btn btn-primary btn-sm"}," + Sitio Web "),t("button",{type:"button",onClick:e[8]||(e[8]=l=>s(v)("instagram")),class:"btn btn-primary btn-sm bg-pink-400 border-pink-600 hover:bg-pink-500 hover:border-pink-600 hover:text-white"}," + Instagram "),t("button",{type:"button",onClick:e[9]||(e[9]=l=>s(v)("facebook")),class:"btn btn-primary btn-sm bg-blue-400 border-blue-600 hover:bg-blue-500 hover:border-blue-600 hover:text-white"}," + Facebook "),t("button",{type:"button",onClick:e[10]||(e[10]=l=>s(v)("whatsapp")),class:"btn btn-primary btn-sm bg-green-400 border-green-600 hover:bg-green-500 hover:border-green-600 hover:text-white"}," + WhatsApp "),t("button",{type:"button",onClick:e[11]||(e[11]=l=>s(v)("email")),class:"btn btn-primary btn-sm bg-gray-400 border-gray-600 hover:bg-gray-500 hover:border-gray-600 hover:text-white"}," + Email ")]),t("div",Re,[p(t("select",{"onUpdate:modelValue":e[12]||(e[12]=l=>c.value=l),class:"select select-bordered flex-1"},[e[24]||(e[24]=t("option",{value:""},"Otra red social...",-1)),(o(!0),r(D,null,q(K.value,l=>(o(),r("option",{key:l.value,value:l.value},d(l.label),9,Ge))),128))],512),[[ce,c.value]]),t("button",{type:"button",onClick:Y,class:"btn btn-primary",disabled:!c.value}," Agregar ",8,Qe)])]),t("div",We,[R(le,{to:"/profiles",class:"btn btn-default"},{default:me(()=>e[26]||(e[26]=[N(" Cancelar ",-1)])),_:1,__:[26]}),t("button",{type:"submit",class:"btn btn-primary",disabled:s(I)},[s(I)?(o(),r("span",Ze)):i("",!0),N(" "+d(s(I)?"Guardando...":"Guardar Cambios"),1)],8,Oe)]),s(B)?(o(),r("div",He,[e[27]||(e[27]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),t("span",null,d(s(B)),1)])):i("",!0)],32),s(L)?(o(),r("section",Je,[e[28]||(e[28]=t("h3",{class:"text-lg font-semibold mb-2"},"Perfil público",-1)),t("div",Ke,[t("div",Xe,[t("div",Ye,[t("h2",et,d(s(_)),1),t("p",tt,d(s(C)||s(S)),1)]),t("div",st,[t("a",{href:`${s(E)}/p/${s(L)}`,target:"_blank",class:"text-primary font-mono text-xs hover:underline"}," /"+d(s(L)),9,lt),t("div",ot,[R(ge,{value:`${s(E)}/p/${s(L)}`,size:150},null,8,["value"])])])])])])):i("",!0),t("div",nt,[e[29]||(e[29]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1)),e[30]||(e[30]=t("div",null,[t("h3",{class:"font-bold"},"Zona peligrosa")],-1)),t("button",{onClick:e[13]||(e[13]=l=>te(s(w))),class:"btn btn-error btn-sm"}," Eliminar permanentemente ")])]),b.value?(o(),pe(we,{key:0,show:b.value,onConfirm:se,onCancel:e[14]||(e[14]=l=>b.value=!1)},null,8,["show"])):i("",!0)],64)}}};export{dt as default};
