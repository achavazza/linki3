import{a as n,p as V,c as d,b as l,d as e,y as p,n as P,B as C,u as U,q as j,o as B,x as L,C as D,e as q,z as M,j as z,t as b,F as R,f as N,h as Q,D as E,g as k,w as A}from"./index-rAF5i6Tv.js";import{Q as w}from"./qrcode.vue.esm-D401QsQY.js";const G={class:"modal-box max-w-2xl relative"},T={class:"flex flex-col items-center py-6"},O={class:"w-64 h-64 mb-4",ref:"qrRef"},F={id:"qr-canvas-hidden",style:{position:"absolute",left:"-9999px",top:"-9999px"}},I={__name:"QrModal",props:{profileSlug:{type:String,required:!0}},setup(S,{expose:u}){const r=n(!1),v=()=>r.value=!0,i=()=>r.value=!1;u({openModal:v,closeModal:i});const c=V(),g=S,f=n(`${window.location.origin}/p/${g.profileSlug}`),m=n(null),x=n(null),y=async()=>{await C();const s=document.querySelector("#qr-canvas-hidden canvas");if(!s){c.error("No se pudo encontrar el canvas");return}const o=s.toDataURL("image/png"),t=document.createElement("a");t.href=o,t.download=`qr-${g.profileSlug}.png`,document.body.appendChild(t),t.click(),document.body.removeChild(t),c.success("QR descargado como PNG")},a=async()=>{await C();const s=document.querySelector("#qr-canvas-hidden svg");if(!s){c.error("No se pudo encontrar el SVG");return}s.setAttribute("xmlns","http://www.w3.org/2000/svg");const t=new XMLSerializer().serializeToString(s),_=new Blob([t],{type:"image/svg+xml"}),$=URL.createObjectURL(_),h=document.createElement("a");h.href=$,h.download=`qr-${g.profileSlug}.svg`,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL($),c.success("QR descargado como SVG")};return(s,o)=>(l(),d("div",{class:P(["modal",{"modal-open":r.value}])},[e("div",G,[o[1]||(o[1]=e("h3",{class:"font-bold text-lg"},"Descargar Código QR",-1)),e("button",{onClick:i,class:"absolute top-3 right-3 btn btn-square btn-sm btn-default size-10","aria-label":"Cerrar modal"},o[0]||(o[0]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),e("div",T,[e("div",O,[p(w,{value:f.value,size:256},null,8,["value"])],512),e("div",{class:"flex gap-4"},[e("button",{onClick:y,class:"btn btn-primary"},"Descargar PNG"),e("button",{onClick:a,class:"btn btn-primary"},"Descargar SVG")])]),e("div",F,[p(w,{ref_key:"qrCanvasRef",ref:m,value:f.value,size:256,"render-as":"canvas",margin:"2"},null,8,["value"]),p(w,{ref_key:"qrSvgRef",ref:x,value:f.value,size:256,"render-as":"svg",margin:"2"},null,8,["value"])])])],2))}},X={class:"max-w-3xl mx-auto px-4 py-6"},H={class:"flex justify-between items-center mb-6"},J={key:0,class:"alert alert-error"},K={key:1,class:"text-center text-gray-600"},W={key:2,class:"space-y-4"},Y={class:"card-body"},Z={class:"flex flex-col md:flex-row md:justify-between gap-4"},ee={class:"flex-1 flex flex-col justify-between"},te={class:"flex items-center gap-2"},se={class:"card-title truncate"},ae={class:"text-gray-600 text-sm truncate"},oe={class:"flex flex-wrap gap-2 mt-2"},le={class:"w-full flex items-left"},ne={class:"label cursor-pointer gap-2"},re=["onUpdate:modelValue","onChange"],ie={class:"w-full flex gap-2"},ce=["href"],de=["onClick"],ue={class:"flex flex-col items-end gap-2"},ve=["href"],ge={class:"w-36 h-36"},me={__name:"ProfileList",setup(S){const u=U(),r=window.location.origin,v=n(!0),i=n(null),c=V(),g=j(()=>u.profiles),f=n(null),m=n(""),x=async a=>{try{v.value=!0;const{error:s}=await u.updateProfile(a.id,{active:a.active});if(s)throw s;c.info(`Perfil ${a.active?"activado":"desactivado"}`)}catch(s){c.error("Error al actualizar el perfil"),console.error(s),a.active=!a.active}finally{v.value=!1}},y=async a=>{m.value=a,await C(),f.value?.openModal()};return B(async()=>{try{v.value=!0,i.value=null,await u.initUser(),await u.fetchProfiles()}catch(a){i.value="Error al cargar los perfiles",console.error(a)}finally{v.value=!1}}),(a,s)=>{const o=L("router-link");return l(),d(R,null,[e("div",X,[e("div",H,[s[1]||(s[1]=e("h1",{class:"text-2xl font-bold"},"Mis Perfiles",-1)),p(o,{to:"/profiles/new",class:"btn btn-default"},{default:M(()=>s[0]||(s[0]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-6"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4.5v15m7.5-7.5h-15"})],-1),z(" Agregar Perfil ",-1)])),_:1,__:[0]})]),i.value?(l(),d("div",J,[s[2]||(s[2]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("span",null,b(i.value),1)])):q("",!0),g.value.length===0?(l(),d("div",K," Aún no tienes perfiles. ")):(l(),d("div",W,[(l(!0),d(R,null,N(g.value,t=>(l(),d("div",{key:t.id,class:"card bg-base-100 border-base-200 border rounded-xl"},[e("div",Y,[e("div",Z,[e("div",ee,[e("div",null,[e("div",te,[e("h2",se,b(t.display_name),1)]),e("p",ae,b(t.tagline||t.description),1)]),e("div",oe,[e("div",le,[e("label",ne,[Q(e("input",{type:"checkbox","onUpdate:modelValue":_=>t.active=_,onChange:_=>x(t),class:"toggle toggle-primary"},null,40,re),[[E,t.active]]),e("div",{class:P(["badge",t.active?"badge-success":"badge-default"])},b(t.active?"Activo":"Inactivo"),3)])]),e("div",ie,[e("a",{href:`${k(r)}/p/${t.slug}`,target:"_blank",class:"btn btn-default btn-sm"}," Ver ",8,ce),p(o,{to:`/profiles/${t.id}/edit`,class:"btn btn-default btn-sm"},{default:M(()=>s[3]||(s[3]=[z(" Editar ",-1)])),_:2,__:[3]},1032,["to"]),e("a",{href:"#",onClick:A(_=>y(t.slug),["prevent"]),class:"btn btn-sm btn-default"}," Descargar QR ",8,de)])])]),e("div",ue,[e("a",{href:`${k(r)}/p/${t.slug}`,target:"_blank",class:"text-primary text-xs hover:underline"}," /"+b(t.slug),9,ve),e("div",ge,[p(w,{value:`${k(r)}/p/${t.slug}`,size:150},null,8,["value"])])])])])]))),128))]))]),m.value?(l(),D(I,{key:0,ref_key:"qrModal",ref:f,"profile-slug":m.value},null,8,["profile-slug"])):q("",!0)],64)}}};export{me as default};
